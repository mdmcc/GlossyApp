<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-B">
  <title>Customer Appointment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="./assets/logo_16colour.gif" type="image/gif" sizes="16x16">
  <link href="css/bootstrap.css" rel="stylesheet">
  <link rel="stylesheet" href="css/my.css"/>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src='js/moment.min.js'></script>
  <script src='js/jquery.min.js'></script>
  <script src='js/jquery-ui.custom.min.js'></script>
  <script src='js/fullcalendar.min.js'></script>
  <script src='js/fullcalendar.js'></script>
  <script src="js/bootstrap.js" ></script>
  <script src="js/npm.js"></script>
  <script type="text/javascript" src="js/script.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?callback=loadMyMap&libraries=places"async defer></script>
  <script src="js/customerMap.js"></script>
</head>
<body>
    <div class="container">

        <div class="row" >
          <div class="col-xs-12 logo" >
            <img src = "./assets/logo_16colour.gif" alt = "logo" id = "logo"/>
          </div>
        </div>
       
    <form id="customerForm" role="form">
      <div class="row">
          <div class="col-xs-12 who" id = "profilesubhead">
            Appointment 
          </div>
      </div>

    	<div class="row">
        <div class="col-xs-12 who" id = "profilesubhead">
          Pick one or a combination of services you would like to have done
        </div>
      </div>

      <hr>

      <div class="row appselect">
        <div class="col-xs-4 servicesBox">Cut:</div>
          <select class="col-xs-8 login3" id="cut" name="cut">
            <option value='0'>N/A</option>
            <option value='1'>Simple: Services ranging from a trim to one length hair cuts - $50</option>
            <option value='2'>Premium: Complex hair cuts including many layers - $90</option>
          </select>  
      </div>
            
      <div class="row appselect2">
        <div class="col-xs-4 servicesBox">Colour:</div>
          <select class="col-xs-8 login3" id="color" name="color">
            <option value='0'>N/A</option>
            <option value='1'>Simple: Services ranging from single process colour or partial highlights - $70</option>
            <option value='2'>Premium: Services ranging from colour and partial highlights to full set of highlights - $140</option>
          </select>  
      </div> 
            
      <div class="row appselect2">
        <div class="col-xs-4 servicesBox">Styling:</div>
          <select class="col-xs-8 login3" id="styling" name="styling">
            <option value='0'>N/A</option>
            <option value='1'>Simple: Blow out - $50</option>
            <option value='2'>Premium: Updo - $90</option>
          </select> 
      </div>

      <hr>

      <div class="row">
        <div class="col-xs-12 who" id = "profilesubhead">
          Pick the date and time of the appointment
        </div>
      </div>
             
      <input class = "cal" type="text" name="appointment" value="" />
           
      <hr>
      <div class="row">
        <div class="col-xs-12 who" id = "profilesubhead">
          Pick the location where you would like the appointment to be held
        </div>
      </div>

      <div class="col-xs-12">
        <input id="pacinput" class="controls" type="text" placeholder="Search Google Maps">
        <div id="gogmap2" class="mapheight poscenter mapcolor"> 
            GOOGLE MAPS
        </div>
      </div>
     </form>    

      <hr>
            
      <div class="row logbut">
        <button type="button" id="customerSubmit" class="col-xs-12 btn btn-success">Next</button>
      </div>
            
      <div class="row logbut">
        <a href="javascript:history.back()">
          <button type="button" class="col-xs-12 btn btn-default">Back</button>
        </a>
      </div>

      <nav> 
        <div class="footrow">
          <a href="customer_profile_edit.html">
            <button type="button" class="btn btn-default" id = "footerbut"><img src = "./assets/profile.gif" id = "buttonimg1"/></button>
          </a>
          <a href="customer_appointment.html">
            <button type="button" class="btn btn-default current" id = "footerbut"><img src = "./assets/blowdryer.gif" id = "buttonimg2"></button>
          </a>
          <a href="customer_calendar.html">
            <button type="button" class="btn btn-default" id = "footerbut"><img src = "./assets/calendartrans.gif" id = "buttonimg3"/></button>
          </a>
          <a href="about.html">
            <button type="button" class="btn btn-default" id = "footerbut"><img src = "./assets/info.gif" id = "buttonimg4"></button>
          </a>
        </div>
      </nav>
    </div> 
            
  
    <script type="text/javascript">

      $(function(event) { // tell it to grab the combination of services from the dropdown and send to appointment_service table BEFORE going onto next functions
        //event.preventDefault();

        $.ajax({
          url:"php/customerSubmit.php",
          dataType:"json",
          type:"POST",
     
          data:{
            cut_type: $('#cut').find(":selected").val(), 
            color_type: $('#color').find(":selected").val(), 
            styling_type: $('#styling').find(":selected").val()
          },
        });
      });


      $(function() {
        $('input[name="appointment"]').daterangepicker({
          singleDatePicker: true,
          showDropdowns: true,
          timePicker: true,
          timePickerIncrement: 15,
          locale: {
            format: 'YYYY-MM-DD hh:mm:00'
          }
        });

      $("#customerSubmit").click(function(event) {
        event.preventDefault();

        $.ajax({
          url:"php/customerSubmit.php",
          dataType:"json",
          type:"POST",
          data:{
            customer_id: 2,
            appointment_service_id: 1, 
            cut_type: $('#cut').find(":selected").val(), // can these stay here, or do they have to be moved?
            color_type: $('#color').find(":selected").val(), 
            styling_type: $('#styling').find(":selected").val(), 
            customer_dateTime: $('input[name="appointment"]').val(),
            customer_lat: lat,
            customer_lng: lng,
            hairStylist_id: "NULL"
          },

          success: function(resp){
            document.location.href="customer_calendar.html"; 
          },

          error: function(XMLHttpRequest, textStatus, errorThrown) { 
              console.log("Status: " + textStatus); 
              console.log("Error: " + errorThrown);
              console.log(XMLHttpRequest); 
          }
        });
      });
      });
    </script>
</body>
</html>